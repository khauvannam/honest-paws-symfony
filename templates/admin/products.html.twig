{% extends 'admin.html.twig' %}
{% block tieude %} <p class="text-2xl font-bold">Quản lý sản phẩm</p> {% endblock %}
{% block content %}
    <!-- Navbar -->
    <nav class="p-4 text-center m-6">
        <div class="container mx-auto">
            <h1 class="text-black text-2xl">Quản lý sản phẩm</h1>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mx-auto mt-8">
        <!-- Button to open the modal -->
<a class="flex justify-between mb-4">
    <h2 class="text-xl font-semibold">Danh sách sản phẩm</h2>
    <button id="openModalButton" class="bg-blue-500 text-white px-4 py-2 rounded">Thêm sản phẩm</button>
</a>

<!-- The Modal with Overlay -->
    <div id="productModal" class="fixed z-10 inset-0 hidden">
        <!-- Overlay -->
        <div id="overlay" class="absolute inset-0 bg-black opacity-50"></div>

        <!-- Modal Content -->
        <div class="flex items-center justify-center min-h-screen">
            <div class="bg-white p-8 rounded-lg shadow-lg max-w-md w-full relative z-20">
                <button id="closeModalButton" class="text-gray-500 hover:text-gray-700 float-right">&times;</button>
                <div class="w-full flex justify-center text-main">
                    <div class="max-w-md w-full my-7 mx-10 bg-white rounded-lg">
                        <h1 class="text-2xl font-bold mb-4 text-center">Tạo Sản Phẩm</h1>
                        {{ form_start(form, { 'attr': { 'class': 'form' } }) }}
                        <div class="mb-4">Tên sản phẩm:
                            {{ form_widget(form.name, { 'attr': { 'class': 'form-control mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm' } }) }}
                        </div>
                        <div class="mb-4">Số lượng sản phẩm:
                            {{ form_widget(form.quantity, { 'attr': { 'class': 'form-control mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm' } }) }}
                        </div>
                        <div class="mb-4">Giá sản phẩm:
                            {{ form_widget(form.price, { 'attr': { 'class': 'form-control mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm' } }) }}
                        </div>
                        <div class="mb-4">Mô tả:
                            {{ form_widget(form.description, { 'attr': { 'class': 'form-control mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm' } }) }}
                        </div>
                        <div class="mb-4">Hướng dẫn sử dụng:
                            {{ form_widget(form.productUseGuide, { 'attr': { 'class': 'form-control mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm' } }) }}
                        </div>
                        <div class="mb-4">Hình ảnh:
                            {{ form_widget(form.imgFile, { 'attr': { 'class': 'form-control relative m-0 block w-full min-w-0 flex-auto cursor-pointer rounded border border-solid border-gray-300 bg-transparent bg-clip-padding px-3 py-[0.32rem] text-base font-normal leading-[2.15] text-surface transition duration-300 ease-in-out file:-mx-3 file:-my-[0.32rem] file:me-3 file:cursor-pointer file:overflow-hidden file:rounded-none file:border-0 file:border-e file:text-main file:border-solid file:border-inherit file:bg-transparent file:px-3 file:py-[0.32rem] file:text-surface focus:border-primary focus:text-main focus:shadow-inset focus:outline-none file:border-[#00205c]' } }) }}
                        </div>
                        <div class="mb-4">Giảm giá:
                            {{ form_widget(form.discountPercent, { 'attr': { 'class': 'form-control mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm' } }) }}
                        </div>
                        <div class="mb-4">Chọn danh mục:
                            {{ form_widget(form.categoryId, { 'attr': { 'class': 'form-control mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm' } }) }}
                        </div>
                        <div>
                            {{ form_widget(form.save, { 'attr': { 'class': 'w-full inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500' } }) }}
                        </div>
                        {{ form_end(form) }}
                    </div>
                </div>
            </div>
        </div>
    </div>

        <!-- Product Table -->
        <div class="bg-white shadow-md rounded">
            <table class="min-w-full table-auto">
                <thead class="bg-gray-200">
                    <tr>
                        <th class="px-4 py-2">Hình ảnh</th>
                        <th class="px-4 py-2">Tên sản phẩm</th>
                        <th class="px-4 py-2">Giá</th>
                        <th class="px-4 py-2">Phần trăm giảm giá</th>
                        <th class="px-4 py-2">Danh mục</th>
                        <th class="px-4 py-2">Số lượng còn lại</th>
                        <th class="px-4 py-2">Số lượng đã bán</th>
                        <th class="px-4 py-2">Hành động</th>
                    </tr>
                </thead>
                <tbody>
                    {% for product in products %}
                        <tr class="text-center">
                            <td class="px-4 py-2">
                                <img src="{{ asset('img/blobs/' ~ product.imageUrl) }}" alt="{{ product.name }}" width="100" class="rounded">
                            </td>
                            <td class="px-4 py-2">{{ product.name }}</td>
                            <td class="px-4 py-2">{{ product.price }}</td>
                            <td class="px-4 py-2">{{ product.getDiscountPercent() }}</td>
                            {% for category in categories %}
                                {% if category.id == product.getCategoryId() %}
                                    <td class="px-4 py-2">{{ category.name }}</td>
                                {% endif %}
                            {% endfor %}
                            <td class="px-4 py-2">{{ product.quantity }}</td>
                            <td class="px-4 py-2">{{ product.getSoldQuantity() }}</td>
                            <td class="px-4 py-2">
                                <a href="{{ path('product_edit', {'id': product.id}) }}" class="bg-blue-500 text-white px-4 py-2 rounded">Sửa</a>
                                <a href="{{ path('product_delete', {'id': product.id}) }}" class="bg-red-500 text-white px-4 py-2 rounded">Xóa</a>
                            </td>
                        </tr>
                    {% endfor %}
                    <!-- Thêm các dòng sản phẩm khác tương tự -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Get the modal, open button, and close button elements
        var modal = document.getElementById("productModal");
        var openModalButton = document.getElementById("openModalButton");
        var closeModalButton = document.getElementById("closeModalButton");
        var overlay = document.getElementById("overlay");

        // Open the modal when the button is clicked
        openModalButton.onclick = function() {
            modal.classList.remove("hidden");
        }

        // Close the modal when the close button is clicked
        closeModalButton.onclick = function() {
            modal.classList.add("hidden");
        }

        // Close the modal if the user clicks on the overlay
        overlay.onclick = function() {
            modal.classList.add("hidden");
        }
    </script>
{% endblock %}